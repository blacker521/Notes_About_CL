---
typora-root-url: ./
---

# 2021.3.3
## [What Makes for Good Views for Contrastive Learning](https://arxiv.org/pdf/2005.10243.pdf) 
主要对比了几种常见的对比学习，为什么能取得比较好的效果。
在保持与下游任务相关的信息的同时，减少视图之间的MI，才能取得比较好的效果。
数据增强是一种有效减小不同视图之间的MI的一种方法
建立视图不变表示的能力是研究核心
**对比表示学习的最佳视图是依赖于任务的**
如果共享信息小，则学习表示可以对输入的详细信息，并实现对多余变量不变的程度更大。

### 提出了三个定义

1. **Sufficient Encoder **
	![](.\img\c_1001.png)
2. **Minimal Sufficient Encoder. **
	![](.\img\c_1002.png)
3. **Optimal Representation of a Task.**
	![](.\img\c_1003.png)
### 用实验证明了对于下游任务，对比与下游相关的特征的重要性
![](.\img\c_1004.png)
上图表示，对于视图v1中的xt进行数据增强，可以控制两个 view 之间共享的变量，分别共享位置，数字，背景。
![](.\img\c_1005.png)

1. **表示不同view之间共享的信息对下游任务影响很大**
	比如只共享数字的部分，学习到的特征表示会忽略背景和位置信息，因此在有关位置和背景的下游任务中无法取得比较好的效果。其他的也类似。
2. **当共享多个信息时，往往其中一个信息会占主导地位**
	如共享数字和位置时，数字占据了主要地位，可能是因为卷积本来就不对位置敏感。
### 学习分为三个阶段
![](.\img\c_1006.png)
这样会形成一个U型，最高点定义为甜点，我们的目标就是让两个视图的信息能够刚好达到甜点，不多不少，只学到特定的特征。
![](.\img\c_1007.png)
![](.\img\c_1008.png)
![](.\img\c_1009.png)

### 问题
对特定任务要有不用不同两个视图，有没有能够让下游任务都很好的特征？
运用到图上的话主要问题还在怎样对数据增强的问题？
特征学习是一个反U型，在图像上可以用色彩抖动来消除，图上应该怎样做？还是说这种问题解决不了？


## [Contrastive Multi-View Representation Learning on Graphs](http://proceedings.mlr.press/v119/hassani20a/hassani20a.pdf) 
在图上用最大化互信息MI来学习表示，主要延伸GraphInfoMax 和SimSLR，又有孪生网路的结构又用了对比互信息。
最大化从图的不同结构视图编码的表示之间的MI来引入自监督方法来训练图编码器。

### 观点
1. 将视图数量增加到两个以上不会提高性能，就用两个对比就行
2. 通过对比来自一阶邻居的编码和图扩散这两个视图，可以实现最佳性能
3. 跨视图对比节点和图的编码能够取得更好的结果
4. 与分层图池化方法相比，简单的图读出层在两项任务上均具有更好的性能
5. 应用正则化或归一化对性能有负面的影响
### 模型
![](.\img\c_2001.png)
1. 节点级和图级进行多视图表示学习
2. 图扩散用于生成样本图和其他结构视图。样本图是同一图的相关视图，仅应用于图结构，不应用于初始节点。并进行子图采样。
3. 用两个专用的GNN和MLP（共享权重）学习节点级的表示。
4. 池化层和MLP层为读出功能，读出图级表示
5. 鉴别器讲一个视图的节点表示与另一视图的图级表示进行对比学习
### 数据增强
**数据增强可以分为两种：**
1. 对初始节点特征进行操作的特征空间增强，例如，掩盖或添加高斯噪声
2. 通过添加或删除连接性，子采样或使用最短距离或扩散矩阵生成全局视图，对图结构进行操作的结构空间扩充和破坏。
3. 在大多数情况下，将邻接矩阵转换为扩散矩阵并将这两个矩阵视为同一图结构的两个全等视图，即可获得最佳结果。我们推测是因为邻接矩阵和扩散矩阵提供了，图结构的局部和全局视图分别最大化了从这两个视图中获悉的表示形式之间的一致性，从而使模型可以同时对丰富的局部和全局信息进行编码。
**扩散矩阵定义**
![](.\img\c_2002.png)
### 编码器
将每个GCN层中节点表示的总和串联起来，然后将其馈送到单层前馈网络，以使节点表示与图形表示之间的尺寸大小保持一致。g表示全局的表示![](.\img\c_2003.png)

### 总结
这篇工作不是太好，没有比较好的特点，只是用了两个视角，把图像上的东西搬过来，但是模型还是有些建设性意义的。比较像GCN用在对齐上

## [DEEP GRAPH INFOMAX](https://arxiv.org/abs/1809.10341)

DGI是一种无监督方式学习图结构节点表示的通用方法，依赖于最大化局部表示与相应的全局表示之间的互信息。DGI不依赖于随机游走，因为随机游走以图结构信息为目标，过分强调邻近信息，而且依赖于超参数。
定义的全局是局部信息的拼接
**DGI是DIM在图上的应用**
DIM训练编码器模型，以最大化高级“全局”表示和输入的“局部”（例如图像的补丁）之间的相互信息。 鼓励编码器携带在所有位置都存在的信息类型（因此是全局相关的），例如类别标签的情况。**比卷积捕获的结构更加通用**
对比方法的关键实现细节是如何绘制正样本和负样本。 上面关于无监督图表示学习的先前工作依赖于局部对比损失（强制近端节点具有相似的嵌入）。

**这样对比能学习到远距离的结构相似信息。目标是通过图建立相似节点间的链接**
**学习出一个encoder**

### 模型
1. 通过腐蚀函数对负样本进行采样
2. 通过将输入图传给编码器来获得表示hi（正样本）
3. 通过负样本传给编码器来获得表示hj（负样本）
4. 通过读出函数获得全局的表示（平均正样本的表示）
5. 通过判别器和Loss进行更新
![](.\img\c_2004.png)
![](.\img\c_2005.png)
### 局部特征
![](.\img\c_2006.png)
### 全局特征
![](.\img\c_2007.png)
### 获得负样本表示
![](.\img\c_2008.png)
### 区分正负样本对（判别器）
![](.\img\c_2009.png)
### 总结
这篇论文是DMI在Graph上的一个应用，取得了比较好的效果

## [Learning deep representations by mutual information estimation and maximization](https://arxiv.org/abs/1808.06670) 

通过最大化深度神经网络编码器的输入输之间的互信息来进行无监督的表示学习
**将输入中有关局部性的知识纳入目标，可以显著提高表示形式对下游任务的适用性**
对比学习的鼻祖论文，第一次将MI用作对比损失
由于MINE的问世使得MI能够准确的估算，这也使得通过估算MI来进行计算对比损失较为容易。
**结构信息是非常重要的。利用MI进行表示学习，根据下游任务，最大化表示和输入局部区域之间的平均MI，可以极大地提高例如分类任务的表示质量**
在完整的输入和编码器输出（即全局MI）之间最大化MI通常不足以学习有用的表示
引入了两种新的表示质量度量，一种基于互信息神经估计一种基于神经依赖性度量（NDM）
图1是经典的编码器，把高维的特征编码成低维的向量
![](.\img\c_3001.png)
图2是DMI，高维特征编码成特征图之后压缩成高级特征向量，低级的特征图经过判别器进行打分并和高级特征向量加和
**根据下游任务，在原始的X或者X的子图上进行最大化**
![](.\img\c_3002.png)
最大化本地要素和全局要素之间的相互信息。 首先，我们将图像编码为一个特征图，以反映数据的某些结构方面，例如 空间局部性，我们将这个特征图进一步概括为一个全局特征向量（参见图1）。 然后，我们将该特征向量与每个位置的低级特征图连接起来。 通过附加功能为每个局部-全局对生成一个分数。
# 2020.3.4
## [InfoGraph: Unsupervised and Semi-supervised Graph-Level Representation Learning via Mutual Information Maximization](https://arxiv.org/abs/1908.01000)
论文研究在无监督和半监督情况下学习整个图的表示（图级）
DGI是节点级的预测
最大化图级表示和不同比例的子结构表示（例如节点，边，三角形）之间的相互信息
图形级表示就对跨不同比例的子结构共享的数据各方面进行编码
分为无监督版InfoGraph和半监督版InfoGraph\*
许多图分析任务（例如图分类，回归和聚类）要求将整个图表示为固定长度的特征向量。 尽管可以通过隐式地通过节点级表示获得图形级表示，但是显式提取图形对于面向图形的任务可能更直接，更优化。
在半监督学习中，将大量未标记的样本与少量标记的样本合并在一起以提高模型的准确性，将在这些领域中发挥关键作用。
### 无监督型
![](.\img\c_4001.png)

用卷积学到图级表示后,对一个视图的表示进行合并获得高级的特征表示,并和低级表示输入鉴别器,鉴别器将[全局表示,局部表示]对,作为输入,并确定他们是不是来自同一个图。InfoGraph使用批处理的方式生成所有可能的正样本和负样本。
如图所示，例子中有2个输入图（一个批次就这两个）总共生成了7个局部表示，对于蓝色的全局表示，将有7个输入对输入到鉴别器。对于红色的也是如此（红色作为全局表示）
在这种情况下，鉴别器将采用14对[全局，局部]对作为输入。
### 函数设置
首先用GNN学习到局部的表示，，k表层数，v表示节点v，e是边。通过最大化图级之间的相互信息来获得图表示和局部级别的表示形式。
![](.\img\c_4002.png)
再用一个读出函数将所有的局部表示合成为固定长度的图级表示
![](.\img\c_4003.png)
用最大互信息进行对比，u是一个子图
![](.\img\c_4004.png)
用JSD估计的MI和DGI一样
![](.\img\c_4005.png)

###　半监督模型
有两种具有相同体系结构的独立编码器，一种用于监督任务，另一种使用带有未监督目标的带标记和未标记数据（等式4）进行训练。
经过读出函数的都是高级特征表示
![](.\img\c_4006.png)
损失函数为三部分，监督，无监督，MI
![](.\img\c_4007.png)

### 总结
这篇论文主要argue了之前论文没有图级的表示，图级别的分类
用子图的方式去做图分类
虽然说的是图级别的，但是他还是用GCN对结构中的每个节点都进行了编码再合并得到了一个高级的特征向量
感觉和之前的Contrastive Multi-View Representation Learning on Graphs没啥区别。只是那篇文章对输入进行了增强然后用了SimSLR那中孪生框架，这篇文章是用一个网络。
# 2021.3.5
## [SelfMatch: Combining Contrastive Self-Supervision and Consistency for Semi-Supervised Learning](https://arxiv.org/abs/2101.06480)
###  模型SelfMatch
SelfMatch包含两个阶段：
1. 基于对比学习的自我监督预训练。SimCLR
2. 基于增强一致性正则化的半监督微调。FixMatch
![](.\img\c_5001.png)
### 总结
东西没啥，就是两个原来的工作和在了一起。

## [What Should Not Be Contrastive in Contrastive Learning](https://arxiv.org/abs/2008.05659)
引入了一个对比学习框架，该框架不需要事先特定的，与任务相关的不变性的知识，模型学会捕捉通过构建单独的视觉表示的可变和不变因素嵌入到空间，除了扩充之外，每个空间都是不变的。
**数据增强的引入是一把双刃剑**因为每次数据增强都会增加其中的不变性变多，比如，增加旋转可能会有助于航拍图像识别，但是会大大降低解决其他任务的能力。
**在不假定下游不变性的先验知识的情况下，在对比性学习框架中捕获个体变化因素的表示**
不是将图像映射到对所有手工扩增都不变的单个嵌入空间，而是学习构造单独的嵌入子空间，每个子空间对特定扩增敏感，而对其他扩增不敏感。
旨在以统一的表示形式保留有关每个扩增的信息，并学习它们的不变性。然后，可以将经过这些扩充训练的一般表示形式应用于不同的下游任务。
**不需要手动选择数据增强策略**
![](.\img\c_6001.png)
使用“留一法”策略生成多个视图，然后将它们的表示形式投影到具有对比目标的单独的嵌入空间中，其中每个嵌入空间对于所有扩充都是不变的，或者除了一个扩充之外，其余都是不变的。 学习的表示形式可以是一般嵌入空间V（蓝色区域），也可以是嵌入子空间Z（灰色区域）的串联。
随机扩增的任何视图相同实例的模块T映射到嵌入空间中的同一点上。该属性对学习的表示形式有负面影响：
1. 如果将通用性和可传递性应用于必须丢弃的信息是必不可少的任务则会损害通用性和可传递性，例如颜色在鸟类的细粒度分类中起着重要作用
2. 增加额外的扩充十分复杂，因为新的运算符可能对某些类别有帮助，而对其他类别则有害，例如，旋转的花朵可能与原始花朵非常相似，而对于旋转的汽车则不适用； 
3. 控制增强强度的超参数需要针对每种增强进行仔细调整，以在保持快捷方式开放和完全使一个信息源无效之间达到微妙的平衡。

###  LooC 留一法对比学习

框架可以有选择地防止由于扩充而导致的信息丢失，而不是将每个视图都投影到一个不变于所有扩充的嵌入空间中，在我们的LooC方法中，输入图像的表示被投影到多个嵌入空间中，每个嵌入空间都对于当前扩充改变，而对其他扩充则保持不变。这样，每个嵌入子空间专用于单个扩充，并且共享层将同时包含可变不变信息和不变信息。 与几个嵌入空间共同共享表示； 我们要么将共享表示形式转移，要么将所有空间的连接转移给下游任务。
![](.\img\c_6001.png)
![](.\img\c_6002.png)
![](.\img\c_6003.png)
n个增强n+1个z空间，z0是所有的增强都在一起，其他的是不同的增强，每个增强一个嵌入空间

### 总结
本篇论文主要是说，原来的对比学习都是映射到同一空间，但是这样会有害学习其他的特征，所以他把每个特征都映射到单独的特征空间，这个空间里都只有经过这一种数据增强的数据

## [Contrastive and Generative Graph Convolutional Networks for Graph-based Semi-Supervised Learning](https://arxiv.org/abs/2009.07111)
以GCN基础的半监督学习，基于图的半监督学习（SSL）旨在通过图将少数标记数据的标签转移到剩余的大量未标记数据。
首先，通过设计一个半监督的对比损失，可以通过最大化相同数据的不同视图或同一类数据之间的一致性来产生改进的节点表示，因此，丰富的未标记数据和稀缺而有价值的数据标记数据可以共同提供丰富的监督信息，以学习判别性节点表示形式，有助于改善后续的分类结果。
其次，通过使用与输入特征相关的图形生成损失，提取数据特征与输入图形拓扑之间的潜在确定性关系作为SSL的补充监管信号。
**设计了一种新的半监督对比损失，该方法将类别信息附加到了改善节点分类任务的对比表示学习。**
分别获得从全局视图和局部视图生成的节点表示，然后采用半监督的对比损失来最大化从这两个视图学习的表示之间的一致性。
其次，考虑到**图拓扑**本身包含宝贵的信息，可以将其用作SSL的补充监督信号，因此我们使用了一个生成项来**显式地建模图和节点表示之间的关系**。结果，可以通过探索来自数据相似性和图形结构的知识来进一步扩展标记数据的最初有限的监督信息，从而导致改进的数据表示和分类结果。
**通过从两个视图在所获得的表示之间进行对比学习，可以同时对丰富的全局信息和局部信息进行编码**
用GCN学习，从局部视图获取节点表示
![](.\img\c_7001.png)
φ1表示局部视图
用HGCN学习全局的表示，将结构相似的节点重复聚合成超节点φ2表示全局视图
HGCN将结构相似的图节点重复聚合到一组超节点上，这可以生成用于卷积的粗化图并扩大节点的接收场。 然后，应用对称图精炼层以恢复原始图结构，以进行节点级表示学习。 这种分层图卷积模型可以从本地到全局的角度全面捕获节点的信息。

###  模型
![](.\img\c_7002.png)

一张图复制有一份，一份经过GCN生成局部视角的表示，另一部分通过HGCN生成全局视角的表示。对比两个视角之间的损失。

损失 = 半监督对比损失 + 生成损失 + 交叉熵损失
#### 半监督对比损失
![](.\img\c_7003.png)
![](.\img\c_7004.png)
### 生成损失（为了学习图拓扑结构）
![](.\img\c_7006.png)
### 总损失
![](.\img\c_7008.png)
### 伪代码
![](.\img\c_7007.png)